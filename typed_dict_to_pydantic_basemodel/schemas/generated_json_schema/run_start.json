{
   "type": "object",
   "properties": {
      "data_session": {
         "type": [
            "string",
            "null"
         ],
         "description": "An optional field for grouping runs. The meaning is not mandated, but this is a data management grouping and not a scientific grouping. It is intended to group runs in a visit or set of trials."
      },
      "data_groups": {
         "type": [
            "array",
            "null"
         ],
         "items": {
            "type": "string"
         },
         "description": "An optional list of data access groups that have meaning to some external system. Examples might include facility, beamline, end stations, proposal, safety form."
      },
      "project": {
         "type": [
            "string",
            "null"
         ],
         "description": "Name of project that this run is part of"
      },
      "sample": {
         "type": [
            "object",
            "string",
            "null"
         ],
         "description": "Information about the sample, may be a UID to another collection"
      },
      "scan_id": {
         "type": [
            "integer",
            "null"
         ],
         "description": "Scan ID number, not globally unique"
      },
      "time": {
         "type": "number",
         "description": "Time the run started.  Unix epoch time"
      },
      "uid": {
         "type": "string",
         "description": "Globally unique ID for this run"
      },
      "group": {
         "type": [
            "string",
            "null"
         ],
         "description": "Unix group to associate this data with"
      },
      "owner": {
         "type": [
            "string",
            "null"
         ],
         "description": "Unix owner to associate this data with"
      },
      "projections": {
         "type": [
            "array",
            "null"
         ],
         "items": {
            "type": "object",
            "properties": {
               "name": {
                  "type": [
                     "string",
                     "null"
                  ],
                  "description": "The name of the projection"
               },
               "version": {
                  "type": "string",
                  "description": "The version of the projection spec. Can specify the version of an external specification."
               },
               "configuration": {
                  "type": "object",
                  "description": "Static information about projection"
               },
               "projection": {
                  "type": "object",
                  "additionalProperties": {
                     "type": "object",
                     "properties": {
                        "type": {
                           "type": [
                              "string",
                              "null"
                           ],
                           "enum": [
                              "linked",
                              "calculated",
                              "static"
                           ],
                           "description": "linked: a value linked from the data set, calculated: a value that requires calculation, static:  a value defined here in the projection "
                        },
                        "stream": {
                           "type": [
                              "string",
                              "null"
                           ]
                        },
                        "location": {
                           "type": [
                              "string",
                              "null"
                           ],
                           "enum": [
                              "start",
                              "event",
                              "configuration"
                           ],
                           "description": "start comes from metadata fields in the start document, event comes from event, configuration comes from configuration fields in the event_descriptor document"
                        },
                        "field": {
                           "type": [
                              "string",
                              "null"
                           ]
                        },
                        "config_index": {
                           "type": [
                              "integer",
                              "null"
                           ]
                        },
                        "config_device": {
                           "type": [
                              "string",
                              "null"
                           ]
                        },
                        "calculation": {
                           "type": [
                              "object",
                              "null"
                           ],
                           "properties": {
                              "callable": {
                                 "type": "string",
                                 "description": "callable function to perform calculation"
                              },
                              "args": {
                                 "type": [
                                    "array",
                                    "null"
                                 ]
                              },
                              "kwargs": {
                                 "type": [
                                    "object",
                                    "null"
                                 ],
                                 "description": "kwargs for calcalation callable"
                              }
                           },
                           "required": [
                              "callable",
                              "args",
                              "kwargs"
                           ],
                           "additionalProperties": false,
                           "title": "calculation properties",
                           "description": "required fields if type is calculated"
                        },
                        "value": {
                           "description": "value explicitely defined in the projection when type==static."
                        }
                     },
                     "required": [
                        "type",
                        "stream",
                        "location",
                        "field",
                        "config_index",
                        "config_device",
                        "calculation",
                        "value"
                     ],
                     "additionalProperties": false
                  },
                  "pattern": "."
               }
            },
            "required": [
               "name",
               "version",
               "configuration",
               "projection"
            ],
            "additionalProperties": false
         }
      },
      "hints": {
         "type": [
            "object",
            "null"
         ],
         "properties": {
            "dimensions": {
               "type": [
                  "array",
                  "null"
               ],
               "items": {
                  "type": "array",
                  "items": {
                     "anyOf": [
                        {
                           "type": "array",
                           "items": {
                              "type": "string"
                           }
                        },
                        {
                           "type": "string"
                        }
                     ]
                  }
               },
               "description": "The independent axes of the experiment.  Ordered slow to fast"
            }
         },
         "required": [
            "dimensions"
         ],
         "additionalProperties": false,
         "description": "Start-level hints"
      }
   },
   "required": [
      "data_session",
      "data_groups",
      "project",
      "sample",
      "scan_id",
      "time",
      "uid",
      "group",
      "owner",
      "projections",
      "hints"
   ],
   "additionalProperties": false,
   "$schema": "http://json-schema.org/draft/2020-12/schema#",
   "description": "Document created at the start of run.  Provides a seach target and later documents link to it",
   "title": "run_start"
}